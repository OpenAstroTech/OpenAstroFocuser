# Copyright (c) 2025
# SPDX-License-Identifier: Apache-2.0

# Enable C++ support and the standard library used by the Moonlite protocol stack.
CONFIG_CPP=y
CONFIG_STD_CPP20=y
CONFIG_GLIBCXX_LIBCPP=y
CONFIG_MOONLITE=y

# Build as an MCUboot-chainloaded image and sign it.
CONFIG_BOOTLOADER_MCUBOOT=y
# ESP32 defaults to unsigned images when MCUboot is enabled; override so signing runs.
CONFIG_MCUBOOT_GENERATE_UNSIGNED_IMAGE=n
CONFIG_MCUBOOT_SIGNATURE_KEY_FILE="bootloader/mcuboot/root-rsa-2048.pem"

# Provide heap storage for std::string and other dynamic allocations.
CONFIG_HEAP_MEM_POOL_SIZE=4096

# Enable Serial/UART driver
CONFIG_SERIAL=y
CONFIG_UART_INTERRUPT_DRIVEN=y

# Enable Console (printk)
CONFIG_CONSOLE=y
CONFIG_UART_CONSOLE=y

# Enable Logging (LOG_INF, LOG_ERR)
CONFIG_LOG=y

# Persist focuser state in flash-backed EEPROM.
CONFIG_EEPROM=y

# Set the application log level.
CONFIG_APP_LOG_LEVEL_INF=y

CONFIG_COUNTER=y

# Enable Zephyr's generic stepper controller subsystem and the TMC2209 backend.
CONFIG_STEPPER=y
CONFIG_STEPPER_ADI_TMC2209=y

# Grow the main thread stack to accommodate the C++ runtime initialisation.
CONFIG_MAIN_STACK_SIZE=3072
